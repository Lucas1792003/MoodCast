{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waiya/Desktop/MoodCast/MoodCast/src/app/api/weather/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\"\r\nimport type { WeatherResult } from \"@/lib/weather-types\"\r\n\r\nexport async function GET(req: Request) {\r\n  const { searchParams } = new URL(req.url)\r\n\r\n  const lat = Number(searchParams.get(\"lat\"))\r\n  const lon = Number(searchParams.get(\"lon\"))\r\n  const locationName = searchParams.get(\"name\") ?? \"\"\r\n\r\n  if (!Number.isFinite(lat) || !Number.isFinite(lon)) {\r\n    return NextResponse.json({ error: \"Invalid lat/lon\" }, { status: 400 })\r\n  }\r\n\r\n  // NOTE: Open-Meteo needs no key.\r\n    const url =\r\n    `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}` +\r\n    `&current=temperature_2m,relative_humidity_2m,apparent_temperature,weather_code,wind_speed_10m,visibility,is_day` +\r\n    `&daily=sunrise,sunset&forecast_days=1` +\r\n    `&timezone=auto` +\r\n    `&temperature_unit=fahrenheit&wind_speed_unit=mph`\r\n\r\n\r\n  const res = await fetch(url, { next: { revalidate: 300 } })\r\n  if (!res.ok) {\r\n    return NextResponse.json({ error: \"Weather fetch failed\" }, { status: 502 })\r\n  }\r\n\r\n  const data = await res.json()\r\n  const c = data?.current\r\n  if (!c) {\r\n    return NextResponse.json({ error: \"Missing current weather\" }, { status: 502 })\r\n  }\r\n\r\n  const out: WeatherResult = {\r\n    locationName,\r\n    temperature: c.temperature_2m,\r\n    feelsLike: c.apparent_temperature,\r\n    weatherCode: c.weather_code,\r\n    windSpeed: c.wind_speed_10m,\r\n    humidity: c.relative_humidity_2m,\r\n    visibility: c.visibility,\r\n    latitude: lat,\r\n    longitude: lon,\r\n    isDay: Boolean(c.is_day),\r\n    sunrise: data?.daily?.sunrise?.[0] ?? null,\r\n    sunset: data?.daily?.sunset?.[0] ?? null,\r\n    }\r\n\r\n\r\n  return NextResponse.json(out)\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAGO,eAAe,IAAI,GAAY;IACpC,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,IAAI,GAAG;IAExC,MAAM,MAAM,OAAO,aAAa,GAAG,CAAC;IACpC,MAAM,MAAM,OAAO,aAAa,GAAG,CAAC;IACpC,MAAM,eAAe,aAAa,GAAG,CAAC,WAAW;IAEjD,IAAI,CAAC,OAAO,QAAQ,CAAC,QAAQ,CAAC,OAAO,QAAQ,CAAC,MAAM;QAClD,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAkB,GAAG;YAAE,QAAQ;QAAI;IACvE;IAEA,iCAAiC;IAC/B,MAAM,MACN,CAAC,gDAAgD,EAAE,IAAI,WAAW,EAAE,KAAK,GACzE,CAAC,+GAA+G,CAAC,GACjH,CAAC,qCAAqC,CAAC,GACvC,CAAC,cAAc,CAAC,GAChB,CAAC,gDAAgD,CAAC;IAGpD,MAAM,MAAM,MAAM,MAAM,KAAK;QAAE,MAAM;YAAE,YAAY;QAAI;IAAE;IACzD,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAuB,GAAG;YAAE,QAAQ;QAAI;IAC5E;IAEA,MAAM,OAAO,MAAM,IAAI,IAAI;IAC3B,MAAM,IAAI,MAAM;IAChB,IAAI,CAAC,GAAG;QACN,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA0B,GAAG;YAAE,QAAQ;QAAI;IAC/E;IAEA,MAAM,MAAqB;QACzB;QACA,aAAa,EAAE,cAAc;QAC7B,WAAW,EAAE,oBAAoB;QACjC,aAAa,EAAE,YAAY;QAC3B,WAAW,EAAE,cAAc;QAC3B,UAAU,EAAE,oBAAoB;QAChC,YAAY,EAAE,UAAU;QACxB,UAAU;QACV,WAAW;QACX,OAAO,QAAQ,EAAE,MAAM;QACvB,SAAS,MAAM,OAAO,SAAS,CAAC,EAAE,IAAI;QACtC,QAAQ,MAAM,OAAO,QAAQ,CAAC,EAAE,IAAI;IACpC;IAGF,OAAO,gJAAY,CAAC,IAAI,CAAC;AAC3B"}}]
}