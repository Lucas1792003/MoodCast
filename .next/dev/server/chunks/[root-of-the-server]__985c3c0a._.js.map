{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waiya/Desktop/MoodCast/MoodCast/src/app/api/suggestion/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\"\r\n\r\nexport const runtime = \"nodejs\"\r\n\r\ntype WeatherInput = {\r\n  code: number\r\n  isDay: boolean\r\n  temp: number\r\n}\r\n\r\ntype Place = {\r\n  id: string\r\n  name: string\r\n  category:\r\n    | \"dessert\"\r\n    | \"cafe\"\r\n    | \"food\"\r\n    | \"park\"\r\n    | \"museum\"\r\n    | \"mall\"\r\n    | \"cinema\"\r\n    | \"gym\"\r\n    | \"photo\"\r\n    | \"market\"\r\n    | \"other\"\r\n  lat: number\r\n  lon: number\r\n  distanceM: number\r\n  address?: string\r\n  osmUrl?: string\r\n}\r\n\r\ntype Suggestion = {\r\n  headline: string\r\n  message: string\r\n  place?: Pick<Place, \"name\" | \"category\" | \"distanceM\" | \"address\" | \"osmUrl\">\r\n}\r\n\r\ntype ApiOut = {\r\n  weatherUsed: WeatherInput\r\n  kind: string\r\n  primary: Suggestion\r\n  secondary: Suggestion[]\r\n}\r\n\r\ntype CacheEntry<T> = { expires: number; value: T }\r\nconst cache = new Map<string, CacheEntry<any>>()\r\n\r\nfunction pickOne<T>(arr: T[]) {\r\n  return arr[Math.floor(Math.random() * arr.length)]\r\n}\r\n\r\nfunction pickRandom<T>(arr: T[]) {\r\n  return arr.length ? arr[Math.floor(Math.random() * arr.length)] : null\r\n}\r\n\r\n/** Indoor â€œat-homeâ€ ideas (no POIs needed) */\r\nconst INDOOR_IDEAS: Suggestion[] = [\r\n  {\r\n    headline: \"Cozy reading time\",\r\n    message: \"Itâ€™s rainy outside â€” perfect time to read 20â€“30 mins with a warm drink â˜•ðŸ“–\",\r\n  },\r\n  {\r\n    headline: \"Board games with friends\",\r\n    message: \"Rainy vibes = board game vibes. Invite a friend over (or play online) ðŸŽ²\",\r\n  },\r\n  {\r\n    headline: \"Movie night\",\r\n    message: \"Storm outside? Stay in and do a movie + snack combo ðŸ¿\",\r\n  },\r\n  {\r\n    headline: \"Home workout\",\r\n    message: \"Try a quick 10â€“15 min stretch or bodyweight workout. Easy win ðŸ’ª\",\r\n  },\r\n  {\r\n    headline: \"Cook something warm\",\r\n    message: \"Rain day cooking hits different. Make something warm + comforting ðŸœ\",\r\n  },\r\n]\r\n\r\nfunction indoorPrimary(kind: string): Suggestion {\r\n  if (kind === \"storm\") return INDOOR_IDEAS[2]\r\n  if (kind === \"rain\" || kind === \"drizzle\") {\r\n    return pickOne([INDOOR_IDEAS[0], INDOOR_IDEAS[1], INDOOR_IDEAS[4]])\r\n  }\r\n  return pickOne(INDOOR_IDEAS)\r\n}\r\n\r\nfunction indoorSecondary(count: number, excludeHeadline?: string) {\r\n  const pool = INDOOR_IDEAS.filter((x) => x.headline !== excludeHeadline)\r\n  const shuffled = [...pool].sort(() => Math.random() - 0.5)\r\n  return shuffled.slice(0, count)\r\n}\r\n\r\nfunction getCache<T>(key: string): T | null {\r\n  const hit = cache.get(key)\r\n  if (!hit) return null\r\n  if (Date.now() > hit.expires) {\r\n    cache.delete(key)\r\n    return null\r\n  }\r\n  return hit.value as T\r\n}\r\n\r\nfunction setCache<T>(key: string, value: T, ttlMs: number) {\r\n  cache.set(key, { value, expires: Date.now() + ttlMs })\r\n}\r\n\r\nfunction toRad(d: number) {\r\n  return (d * Math.PI) / 180\r\n}\r\n\r\nfunction haversineM(lat1: number, lon1: number, lat2: number, lon2: number) {\r\n  const R = 6371000\r\n  const dLat = toRad(lat2 - lat1)\r\n  const dLon = toRad(lon2 - lon1)\r\n  const a =\r\n    Math.sin(dLat / 2) ** 2 +\r\n    Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) * Math.sin(dLon / 2) ** 2\r\n  return 2 * R * Math.asin(Math.sqrt(a))\r\n}\r\n\r\nfunction classifyWeather(code: number) {\r\n  if (code === 0) return \"clear\"\r\n  if (code === 1 || code === 2) return \"partly\"\r\n  if (code === 3) return \"cloudy\"\r\n  if (code === 45 || code === 48) return \"fog\"\r\n  if ([51, 53, 55, 56, 57].includes(code)) return \"drizzle\"\r\n  if ([61, 63, 65, 66, 67, 80, 81, 82].includes(code)) return \"rain\"\r\n  if ([71, 73, 75, 77, 85, 86].includes(code)) return \"snow\"\r\n  if ([95, 96, 99].includes(code)) return \"storm\"\r\n  return \"unknown\"\r\n}\r\n\r\nfunction buildOverpassQuery(lat: number, lon: number, radiusM: number) {\r\n  return `\r\n[out:json][timeout:25];\r\n(\r\n  // desserts / cafes / food\r\n  nwr(around:${radiusM},${lat},${lon})[\"amenity\"~\"cafe|ice_cream|restaurant|fast_food\"];\r\n  nwr(around:${radiusM},${lat},${lon})[\"shop\"=\"bakery\"];\r\n\r\n  // parks / leisure\r\n  nwr(around:${radiusM},${lat},${lon})[\"leisure\"~\"park|garden\"];\r\n  nwr(around:${radiusM},${lat},${lon})[\"natural\"=\"peak\"];\r\n\r\n  // museums / galleries\r\n  nwr(around:${radiusM},${lat},${lon})[\"tourism\"~\"museum|gallery|attraction|viewpoint\"];\r\n\r\n  // mall / cinema / markets\r\n  nwr(around:${radiusM},${lat},${lon})[\"shop\"=\"mall\"];\r\n  nwr(around:${radiusM},${lat},${lon})[\"amenity\"~\"cinema|theatre\"];\r\n  nwr(around:${radiusM},${lat},${lon})[\"amenity\"=\"marketplace\"];\r\n\r\n  // fitness\r\n  nwr(around:${radiusM},${lat},${lon})[\"leisure\"~\"fitness_centre|sports_centre\"];\r\n);\r\nout center tags;\r\n`\r\n}\r\n\r\nasync function fetchOverpass(lat: number, lon: number, radiusM: number) {\r\n  const key = `overpass:${lat.toFixed(3)}:${lon.toFixed(3)}:${radiusM}`\r\n  const cached = getCache<any>(key)\r\n  if (cached) return cached\r\n\r\n  const res = await fetch(\"https://overpass-api.de/api/interpreter\", {\r\n    method: \"POST\",\r\n    headers: { \"Content-Type\": \"text/plain;charset=UTF-8\" },\r\n    body: buildOverpassQuery(lat, lon, radiusM),\r\n  })\r\n\r\n  if (!res.ok) throw new Error(`Overpass error ${res.status}`)\r\n  const json = await res.json()\r\n\r\n  setCache(key, json, 8 * 60 * 1000) // 8 min\r\n  return json\r\n}\r\n\r\nfunction toCategory(tags: Record<string, string | undefined>): Place[\"category\"] {\r\n  const amenity = tags.amenity\r\n  const shop = tags.shop\r\n  const tourism = tags.tourism\r\n  const leisure = tags.leisure\r\n\r\n  if (amenity === \"ice_cream\" || shop === \"bakery\") return \"dessert\"\r\n  if (amenity === \"cafe\") return \"cafe\"\r\n  if (amenity === \"restaurant\" || amenity === \"fast_food\") return \"food\"\r\n\r\n  if (shop === \"mall\") return \"mall\"\r\n  if (amenity === \"cinema\" || amenity === \"theatre\") return \"cinema\"\r\n  if (amenity === \"marketplace\") return \"market\"\r\n\r\n  if (leisure === \"park\" || leisure === \"garden\") return \"park\"\r\n  if (leisure === \"fitness_centre\" || leisure === \"sports_centre\") return \"gym\"\r\n\r\n  if (tourism === \"museum\" || tourism === \"gallery\") return \"museum\"\r\n  if (tourism === \"viewpoint\" || tourism === \"attraction\") return \"photo\"\r\n\r\n  return \"other\"\r\n}\r\n\r\nfunction elementToPlace(el: any, userLat: number, userLon: number): Place | null {\r\n  const tags = el.tags || {}\r\n  const name = tags.name || tags[\"name:en\"]\r\n  const lat = typeof el.lat === \"number\" ? el.lat : el.center?.lat\r\n  const lon = typeof el.lon === \"number\" ? el.lon : el.center?.lon\r\n  if (!name || typeof lat !== \"number\" || typeof lon !== \"number\") return null\r\n\r\n  const category = toCategory(tags)\r\n  const distanceM = haversineM(userLat, userLon, lat, lon)\r\n\r\n  const osmUrl = el?.type && el?.id ? `https://www.openstreetmap.org/${el.type}/${el.id}` : undefined\r\n\r\n  const addressParts = [\r\n    tags[\"addr:housenumber\"],\r\n    tags[\"addr:street\"],\r\n    tags[\"addr:subdistrict\"],\r\n    tags[\"addr:district\"],\r\n    tags[\"addr:city\"],\r\n  ].filter(Boolean)\r\n  const address = addressParts.length ? addressParts.join(\" \") : undefined\r\n\r\n  return {\r\n    id: `${el.type}/${el.id}`,\r\n    name,\r\n    category,\r\n    lat,\r\n    lon,\r\n    distanceM,\r\n    address,\r\n    osmUrl,\r\n  }\r\n}\r\n\r\nfunction allowedCategories(kind: string, w: WeatherInput) {\r\n  const hot = w.temp >= 32\r\n\r\n  if (kind === \"storm\") {\r\n    return new Set<Place[\"category\"]>([\"mall\", \"cafe\", \"dessert\", \"museum\", \"cinema\", \"gym\", \"food\", \"market\"])\r\n  }\r\n  if (kind === \"rain\" || kind === \"drizzle\") {\r\n    return new Set<Place[\"category\"]>([\"mall\", \"cafe\", \"dessert\", \"museum\", \"cinema\", \"gym\", \"food\", \"market\"])\r\n  }\r\n  if (!w.isDay) {\r\n    return new Set<Place[\"category\"]>([\"cafe\", \"dessert\", \"mall\", \"cinema\", \"food\", \"market\", \"photo\"])\r\n  }\r\n  if (hot) {\r\n    return new Set<Place[\"category\"]>([\"dessert\", \"mall\", \"cafe\", \"museum\", \"cinema\", \"food\", \"gym\", \"market\"])\r\n  }\r\n  if (kind === \"cloudy\" || kind === \"fog\") {\r\n    return new Set<Place[\"category\"]>([\"cafe\", \"food\", \"park\", \"museum\", \"photo\", \"mall\", \"dessert\", \"market\"])\r\n  }\r\n  return new Set<Place[\"category\"]>([\"park\", \"photo\", \"cafe\", \"dessert\", \"food\", \"market\", \"museum\"])\r\n}\r\n\r\nfunction vibeCopy(kind: string, w: WeatherInput, place?: Place): Suggestion {\r\n  const hot = w.temp >= 32\r\n\r\n  const fallback: Suggestion = {\r\n    headline: \"Todayâ€™s vibe\",\r\n    message:\r\n      kind === \"rain\" || kind === \"storm\"\r\n        ? \"Itâ€™s wet outside â€” go for something cozy indoors. A cafe + a small treat sounds perfect.\"\r\n        : hot\r\n          ? \"Itâ€™s hot outside â€” pick something cool and easy. Dessert or an AC spot is a win.\"\r\n          : \"Looks like a nice day â€” go do something simple nearby and enjoy it.\",\r\n  }\r\n\r\n  if (!place) return fallback\r\n\r\n  const name = place.name\r\n  const cat = place.category\r\n\r\n  const placeLine = (msg: string): Suggestion => ({\r\n    headline:\r\n      kind === \"rain\" || kind === \"storm\"\r\n        ? \"Rainy-day plan\"\r\n        : hot\r\n          ? \"Hot-day plan\"\r\n          : w.isDay\r\n            ? \"Daytime plan\"\r\n            : \"Night plan\",\r\n    message: msg,\r\n    place: {\r\n      name: place.name,\r\n      category: place.category,\r\n      distanceM: place.distanceM,\r\n      address: place.address,\r\n      osmUrl: place.osmUrl,\r\n    },\r\n  })\r\n\r\n  if (hot && (cat === \"dessert\" || cat === \"cafe\")) {\r\n    return placeLine(`Hey, itâ€™s hot outside â€” why not cool down at **${name}**? Grab something sweet + hydrate.`)\r\n  }\r\n\r\n  if ((kind === \"rain\" || kind === \"storm\") && (cat === \"mall\" || cat === \"museum\" || cat === \"cinema\")) {\r\n    return placeLine(`Rain vibes today â€” stay dry and comfy. **${name}** nearby could be a perfect indoor plan.`)\r\n  }\r\n\r\n  if ((kind === \"rain\" || kind === \"drizzle\") && (cat === \"cafe\" || cat === \"dessert\")) {\r\n    return placeLine(`Itâ€™s rainy outside â€” cozy mode. Try **${name}** nearby for a warm drink + a small treat.`)\r\n  }\r\n\r\n  if (w.isDay && (cat === \"park\" || cat === \"photo\")) {\r\n    return placeLine(`The weather looks friendly â€” how about heading to **${name}** for a short walk and a few nice photos?`)\r\n  }\r\n\r\n  if (!w.isDay && (cat === \"market\" || cat === \"food\" || cat === \"cafe\")) {\r\n    return placeLine(`Night time = snack time ðŸ˜„ **${name}** is nearby â€” go grab something and take it slow.`)\r\n  }\r\n\r\n  return placeLine(`Hereâ€™s a nearby idea: **${name}**. Keep it simple â€” go for 30â€“60 minutes and enjoy the vibe.`)\r\n}\r\n\r\nfunction toSecondary(place: Place): Suggestion {\r\n  return {\r\n    headline: place.name,\r\n    message: `${place.category} Â· ~${Math.round(place.distanceM)}m away`,\r\n    place: {\r\n      name: place.name,\r\n      category: place.category,\r\n      distanceM: place.distanceM,\r\n      address: place.address,\r\n      osmUrl: place.osmUrl,\r\n    },\r\n  }\r\n}\r\n\r\nexport async function GET(req: NextRequest) {\r\n  const { searchParams } = new URL(req.url)\r\n\r\n  const lat = Number(searchParams.get(\"lat\"))\r\n  const lon = Number(searchParams.get(\"lon\"))\r\n\r\n  const code = Number(searchParams.get(\"code\") ?? 0)\r\n  const isDay = (searchParams.get(\"isDay\") ?? \"1\") === \"1\"\r\n  const temp = Number(searchParams.get(\"temp\") ?? 30)\r\n\r\n  if (!Number.isFinite(lat) || !Number.isFinite(lon)) {\r\n    return NextResponse.json({ error: \"Missing lat/lon\" }, { status: 400 })\r\n  }\r\n\r\n  const weatherUsed: WeatherInput = { code, isDay, temp }\r\n  const kind = classifyWeather(code)\r\n\r\n  const radiusM = 2000\r\n\r\n  // Overpass safe fetch\r\n  let elements: any[] = []\r\n  try {\r\n    const overpass = await fetchOverpass(lat, lon, radiusM)\r\n    elements = Array.isArray(overpass?.elements) ? overpass.elements : []\r\n  } catch {\r\n    elements = []\r\n  }\r\n\r\n  const all = elements\r\n    .map((el) => elementToPlace(el, lat, lon))\r\n    .filter(Boolean) as Place[]\r\n\r\n  // dedup by name+category, keep closest for distance display\r\n  const dedup = new Map<string, Place>()\r\n  for (const p of all) {\r\n    const key = `${p.name.toLowerCase()}::${p.category}`\r\n    const prev = dedup.get(key)\r\n    if (!prev || p.distanceM < prev.distanceM) dedup.set(key, p)\r\n  }\r\n\r\n  const pool = Array.from(dedup.values()).sort((a, b) => a.distanceM - b.distanceM)\r\n\r\n  const allowed = allowedCategories(kind, weatherUsed)\r\n  const filtered = pool.filter((p) => allowed.has(p.category)).slice(0, 80)\r\n\r\n  const badWeather = kind === \"storm\" || kind === \"rain\" || kind === \"drizzle\"\r\n  const preferIndoorPrimary = badWeather && Math.random() < 0.7\r\n\r\n  let primary: Suggestion\r\n  let secondary: Suggestion[] = []\r\n\r\n  try {\r\n    // âœ… Random pick from nearby candidates (not nearest)\r\n    const candidates = (filtered.length ? filtered : pool).slice(0, 30)\r\n    const chosen = pickRandom(candidates)\r\n\r\n    if (preferIndoorPrimary) {\r\n      primary = indoorPrimary(kind)\r\n\r\n      const nearbyIndoor = (filtered.length ? filtered : pool)\r\n        .filter((p) =>\r\n          [\"mall\", \"cafe\", \"dessert\", \"museum\", \"cinema\", \"gym\", \"food\", \"market\"].includes(p.category)\r\n        )\r\n        .filter((p) => (chosen ? p.id !== chosen.id : true))\r\n        .slice(0, 30)\r\n        .sort(() => Math.random() - 0.5)\r\n        .slice(0, 3)\r\n        .map(toSecondary)\r\n\r\n      const extraIndoor = indoorSecondary(2, primary.headline)\r\n      secondary = [...nearbyIndoor, ...extraIndoor].slice(0, 4)\r\n    } else {\r\n      primary = vibeCopy(kind, weatherUsed, chosen ?? undefined)\r\n\r\n      const secondaryPlaces = (filtered.length ? filtered : pool)\r\n        .filter((p) => (chosen ? p.id !== chosen.id : true))\r\n        .slice(0, 30)\r\n        .sort(() => Math.random() - 0.5)\r\n        .slice(0, 4)\r\n        .map(toSecondary)\r\n\r\n      const backupIndoor = badWeather ? indoorSecondary(1, undefined) : []\r\n      secondary = [...secondaryPlaces, ...backupIndoor].slice(0, 4)\r\n    }\r\n  } catch {\r\n    primary = indoorPrimary(kind)\r\n    secondary = indoorSecondary(4, primary.headline)\r\n  }\r\n\r\n  const out: ApiOut = {\r\n    weatherUsed,\r\n    kind,\r\n    primary,\r\n    secondary,\r\n  }\r\n\r\n  return NextResponse.json(out)\r\n}\r\n"],"names":[],"mappings":"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"}}]
}