{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waiya/Desktop/MoodCast/MoodCast/src/app/api/outfits/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\"\r\n\r\nexport const runtime = \"nodejs\"\r\n\r\ntype Gender = \"male\" | \"female\" | \"unisex\"\r\ntype Category = \"head\" | \"outer\" | \"top\" | \"bottom\" | \"shoes\" | \"accessory\"\r\n\r\nexport type OutfitCatalogItem = {\r\n  id: string\r\n  name: string\r\n  category: Category\r\n  gender: Gender\r\n  // Fahrenheit\r\n  minTempF?: number\r\n  maxTempF?: number\r\n  weather?: Array<\"any\" | \"rain\" | \"snow\" | \"wind\" | \"clear\" | \"cloudy\" | \"storm\">\r\n  regions?: string[] // [\"Tokyo\",\"Japan\",\"JP\",\"global\"]\r\n  styleTags?: string[]\r\n}\r\n\r\nfunction asNum(v: string | null) {\r\n  const n = Number(v)\r\n  return Number.isFinite(n) ? n : null\r\n}\r\n\r\nfunction normalizeLocation(location: string) {\r\n  const s = (location || \"\").trim()\r\n  if (!s) return { tokens: [\"global\"] }\r\n\r\n  const parts = s.split(\",\").map((x) => x.trim()).filter(Boolean)\r\n  const city = parts[0] ?? \"\"\r\n  const country = parts[1] ?? \"\"\r\n  const tokens = [city, country, city.toLowerCase(), country.toLowerCase(), \"global\"].filter(Boolean)\r\n\r\n  if (country.toLowerCase() === \"japan\") tokens.push(\"JP\", \"jp\")\r\n  if (city.toLowerCase() === \"tokyo\") tokens.push(\"Tokyo\", \"tokyo\")\r\n  return { tokens }\r\n}\r\n\r\n/**\r\n * Plug your real provider here.\r\n * Keep it server-side so API keys stay safe.\r\n */\r\nasync function fetchProviderCatalog(_opts: {\r\n  location: string\r\n  lat: number | null\r\n  lon: number | null\r\n  gender: Gender\r\n  tempF: number | null\r\n  weatherCode: number | null\r\n}): Promise<OutfitCatalogItem[] | null> {\r\n  const baseUrl = process.env.OUTFIT_API_URL\r\n  if (!baseUrl) return null\r\n\r\n  // Example (adjust to your provider):\r\n  // const url = new URL(baseUrl)\r\n  // url.searchParams.set(\"location\", _opts.location)\r\n  // url.searchParams.set(\"gender\", _opts.gender)\r\n  // if (_opts.tempF != null) url.searchParams.set(\"tempF\", String(_opts.tempF))\r\n  // if (_opts.weatherCode != null) url.searchParams.set(\"weatherCode\", String(_opts.weatherCode))\r\n  //\r\n  // const r = await fetch(url.toString(), {\r\n  //   headers: { Authorization: `Bearer ${process.env.OUTFIT_API_KEY ?? \"\"}` },\r\n  //   cache: \"no-store\",\r\n  // })\r\n  // if (!r.ok) return null\r\n  // const data = await r.json()\r\n  // return normalizeProviderResponse(data)\r\n\r\n  return null\r\n}\r\n\r\n/** Fallback catalog (still gendered + filterable like real data) */\r\nfunction fallbackCatalog(location: string): OutfitCatalogItem[] {\r\n  const { tokens } = normalizeLocation(location)\r\n  const isTokyoish = tokens.includes(\"tokyo\") || tokens.includes(\"Tokyo\") || tokens.includes(\"jp\") || tokens.includes(\"JP\")\r\n\r\n  return [\r\n    // HEAD\r\n    { id: \"head-beanie\", name: \"Beanie\", category: \"head\", gender: \"unisex\", maxTempF: 55, weather: [\"any\"], regions: [\"global\"] },\r\n    { id: \"head-cap\", name: \"Baseball cap\", category: \"head\", gender: \"unisex\", minTempF: 60, weather: [\"clear\", \"cloudy\", \"any\"], regions: [\"global\"] },\r\n\r\n    // OUTER\r\n    { id: \"outer-puffer\", name: \"Puffer jacket\", category: \"outer\", gender: \"unisex\", maxTempF: 45, weather: [\"any\"], regions: [\"global\"] },\r\n    { id: \"outer-hoodie\", name: isTokyoish ? \"Streetwear hoodie\" : \"Hoodie\", category: \"outer\", gender: \"unisex\", maxTempF: 65, weather: [\"any\"], regions: [\"global\"] },\r\n    { id: \"outer-denim-jacket\", name: \"Denim jacket\", category: \"outer\", gender: \"unisex\", minTempF: 55, maxTempF: 75, weather: [\"cloudy\", \"wind\", \"any\"], regions: [\"global\"] },\r\n    { id: \"outer-rain-shell\", name: \"Rain shell\", category: \"outer\", gender: \"unisex\", weather: [\"rain\", \"storm\"], regions: [\"global\"] },\r\n\r\n    // TOP (gender-specific names!)\r\n    { id: \"top-thermal\", name: \"Thermal long-sleeve\", category: \"top\", gender: \"unisex\", maxTempF: 45, weather: [\"any\"], regions: [\"global\"] },\r\n    { id: \"top-sweater\", name: \"Crewneck sweater\", category: \"top\", gender: \"unisex\", maxTempF: 60, weather: [\"any\"], regions: [\"global\"] },\r\n    { id: \"top-tee\", name: \"T-shirt\", category: \"top\", gender: \"unisex\", minTempF: 70, weather: [\"clear\", \"cloudy\", \"any\"], regions: [\"global\"] },\r\n\r\n    { id: \"top-male-oxford\", name: \"Oxford shirt\", category: \"top\", gender: \"male\", minTempF: 55, maxTempF: 80, weather: [\"any\"], regions: [\"global\"] },\r\n    { id: \"top-male-linen\", name: \"Linen shirt\", category: \"top\", gender: \"male\", minTempF: 75, weather: [\"clear\", \"cloudy\", \"any\"], regions: [\"global\"] },\r\n\r\n    { id: \"top-female-blouse\", name: \"Light blouse\", category: \"top\", gender: \"female\", minTempF: 70, weather: [\"clear\", \"cloudy\", \"any\"], regions: [\"global\"] },\r\n    { id: \"top-female-knit\", name: \"Knit cardigan top\", category: \"top\", gender: \"female\", maxTempF: 70, weather: [\"any\"], regions: [\"global\"] },\r\n\r\n    // BOTTOM (gender-specific so male never sees skirt)\r\n    { id: \"bottom-jeans\", name: \"Jeans\", category: \"bottom\", gender: \"unisex\", minTempF: 45, maxTempF: 75, weather: [\"any\"], regions: [\"global\"] },\r\n    { id: \"bottom-shorts\", name: \"Shorts\", category: \"bottom\", gender: \"unisex\", minTempF: 80, weather: [\"clear\", \"cloudy\", \"any\"], regions: [\"global\"] },\r\n\r\n    { id: \"bottom-male-chinos\", name: \"Chinos\", category: \"bottom\", gender: \"male\", minTempF: 55, maxTempF: 80, weather: [\"any\"], regions: [\"global\"] },\r\n    { id: \"bottom-male-trousers\", name: \"Straight-leg trousers\", category: \"bottom\", gender: \"male\", minTempF: 45, maxTempF: 70, weather: [\"any\"], regions: [\"global\"] },\r\n\r\n    { id: \"bottom-female-midi-skirt\", name: \"Midi skirt\", category: \"bottom\", gender: \"female\", minTempF: 55, maxTempF: 80, weather: [\"any\"], regions: [\"global\"] },\r\n    { id: \"bottom-female-wide-leg\", name: \"Wide-leg pants\", category: \"bottom\", gender: \"female\", minTempF: 45, maxTempF: 75, weather: [\"any\"], regions: [\"global\"] },\r\n\r\n    // SHOES\r\n    { id: \"shoes-waterproof\", name: \"Waterproof sneakers\", category: \"shoes\", gender: \"unisex\", weather: [\"rain\", \"storm\", \"any\"], regions: [\"global\"] },\r\n    { id: \"shoes-sneakers\", name: \"Sneakers\", category: \"shoes\", gender: \"unisex\", weather: [\"clear\", \"cloudy\", \"any\"], regions: [\"global\"] },\r\n    { id: \"shoes-boots\", name: \"Boots\", category: \"shoes\", gender: \"unisex\", maxTempF: 55, weather: [\"any\"], regions: [\"global\"] },\r\n\r\n    // ACCESSORY\r\n    { id: \"acc-scarf\", name: \"Scarf\", category: \"accessory\", gender: \"unisex\", maxTempF: 50, weather: [\"any\"], regions: [\"global\"] },\r\n    { id: \"acc-umbrella\", name: \"Umbrella\", category: \"accessory\", gender: \"unisex\", weather: [\"rain\", \"storm\"], regions: [\"global\"] },\r\n    { id: \"acc-sunglasses\", name: \"Sunglasses\", category: \"accessory\", gender: \"unisex\", minTempF: 70, weather: [\"clear\", \"any\"], regions: [\"global\"] },\r\n  ]\r\n}\r\n\r\nexport async function GET(req: Request) {\r\n  const { searchParams } = new URL(req.url)\r\n\r\n  const location = (searchParams.get(\"location\") ?? \"\").trim()\r\n  const gender = (searchParams.get(\"gender\") ?? \"unisex\") as Gender\r\n  const lat = asNum(searchParams.get(\"lat\"))\r\n  const lon = asNum(searchParams.get(\"lon\"))\r\n  const tempF = asNum(searchParams.get(\"tempF\"))\r\n  const weatherCode = asNum(searchParams.get(\"weatherCode\"))\r\n\r\n  const provider = await fetchProviderCatalog({ location, lat, lon, gender, tempF, weatherCode })\r\n  const items = provider ?? fallbackCatalog(location)\r\n\r\n  return NextResponse.json({\r\n    items,\r\n    meta: { location, gender, lat, lon, tempF, weatherCode },\r\n  })\r\n}\r\n"],"names":[],"mappings":"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"}}]
}