{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/waiya/Desktop/MoodCast/MoodCast/src/components/activity-map.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport React, { useEffect, useRef } from \"react\"\r\n\r\ntype LngLat = { lng: number; lat: number }\r\n\r\nexport default function ActivityMap({\r\n  center,\r\n  user,\r\n  destination,\r\n  routeGeojson,\r\n}: {\r\n  center: LngLat\r\n  user?: LngLat\r\n  destination?: LngLat\r\n  routeGeojson?: GeoJSON.FeatureCollection | null\r\n}) {\r\n  const containerRef = useRef<HTMLDivElement | null>(null)\r\n  const mapRef = useRef<any>(null)\r\n  const userMarkerRef = useRef<any>(null)\r\n  const destMarkerRef = useRef<any>(null)\r\n\r\n  useEffect(() => {\r\n    let isMounted = true\r\n\r\n    ;(async () => {\r\n      if (!containerRef.current || mapRef.current) return\r\n\r\n      const maplibregl = (await import(\"maplibre-gl\")).default\r\n\r\n      if (!isMounted) return\r\n\r\n      // OpenFreeMap style URL (free public instance) :contentReference[oaicite:6]{index=6}\r\n      const map = new maplibregl.Map({\r\n        container: containerRef.current,\r\n        style: \"https://tiles.openfreemap.org/styles/liberty\",\r\n        center: [center.lng, center.lat],\r\n        zoom: 13,\r\n      })\r\n\r\n      map.addControl(new maplibregl.NavigationControl({ visualizePitch: true }), \"top-right\")\r\n      mapRef.current = map\r\n    })()\r\n\r\n    return () => {\r\n      isMounted = false\r\n      try {\r\n        mapRef.current?.remove?.()\r\n      } catch {}\r\n      mapRef.current = null\r\n      userMarkerRef.current = null\r\n      destMarkerRef.current = null\r\n    }\r\n  }, [center.lat, center.lng])\r\n\r\n  // Update markers + route\r\n  useEffect(() => {\r\n    ;(async () => {\r\n      const map = mapRef.current\r\n      if (!map) return\r\n\r\n      const maplibregl = (await import(\"maplibre-gl\")).default\r\n\r\n      // user marker\r\n      if (user) {\r\n        if (!userMarkerRef.current) {\r\n          userMarkerRef.current = new maplibregl.Marker({ color: \"#111\" })\r\n            .setLngLat([user.lng, user.lat])\r\n            .addTo(map)\r\n        } else {\r\n          userMarkerRef.current.setLngLat([user.lng, user.lat])\r\n        }\r\n      }\r\n\r\n      // destination marker\r\n      if (destination) {\r\n        if (!destMarkerRef.current) {\r\n          destMarkerRef.current = new maplibregl.Marker({ color: \"#2563eb\" })\r\n            .setLngLat([destination.lng, destination.lat])\r\n            .addTo(map)\r\n        } else {\r\n          destMarkerRef.current.setLngLat([destination.lng, destination.lat])\r\n        }\r\n      }\r\n\r\n      // route line\r\n      const sourceId = \"route-source\"\r\n      const layerId = \"route-layer\"\r\n\r\n      if (routeGeojson) {\r\n        if (map.getSource(sourceId)) {\r\n          ;(map.getSource(sourceId) as any).setData(routeGeojson)\r\n        } else {\r\n          map.addSource(sourceId, { type: \"geojson\", data: routeGeojson as any })\r\n          map.addLayer({\r\n            id: layerId,\r\n            type: \"line\",\r\n            source: sourceId,\r\n            layout: { \"line-join\": \"round\", \"line-cap\": \"round\" },\r\n            paint: { \"line-width\": 5 },\r\n          })\r\n        }\r\n      } else {\r\n        // remove if present\r\n        if (map.getLayer(layerId)) map.removeLayer(layerId)\r\n        if (map.getSource(sourceId)) map.removeSource(sourceId)\r\n      }\r\n\r\n      // fit bounds if we have both\r\n      if (user && destination) {\r\n        const bounds = new maplibregl.LngLatBounds()\r\n        bounds.extend([user.lng, user.lat])\r\n        bounds.extend([destination.lng, destination.lat])\r\n        map.fitBounds(bounds, { padding: 60, maxZoom: 15 })\r\n      }\r\n    })()\r\n  }, [user?.lat, user?.lng, destination?.lat, destination?.lng, routeGeojson])\r\n\r\n  return (\r\n    <div className=\"w-full h-[360px] rounded-3xl overflow-hidden border border-slate-200 bg-slate-50\">\r\n      <div ref={containerRef} className=\"w-full h-full\" />\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}}]
}